---
title: Next.jsへGoogleアナリティクスのGA4とUAを共存させる
created_at: 2022-01-10
tags:
- Next.js
- GoogleAnalytics
---

GoogleアナリティクスからGA4を使ってみませんかって定期的にメールでお知らせしてくるので対応してみた。

## GA4 と UA はぜんぜん違う？
なんか後継みたいな雰囲気（なぜか変換できない（できてる））出してますが、UIからして結構違うシステムらしい？  
なんなら`ユニバーサルアナリティクス (UA)`時代に集計したデータは`Google アナリティクス 4 (GA4)`には引き継げないみたいですよ？

結構違うシステムなので、とりあえず現行の`ユニバーサルアナリティクス (UA)`と新しくなった`Google アナリティクス 4 (GA4)`の両方で同じ様に計測してみます。

メモ

- 既存のGoogle アナリティクス (UA) の設定から、GA4を有効にする
- `analytics.js`の場合は`gtag.js`に書き換える
- `gtag('config', 'G-xxx')`を書き足して、`UA`と共存させる
- ページ遷移のイベントを検知する部分に`GA4`のバージョンを追加する
    - `UA`を引き継いでくれるわけじゃないみたい